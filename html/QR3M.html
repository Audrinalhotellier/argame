<script src="https://cdn.jsdelivr.net/gh/aframevr/aframe@1.3.0/dist/aframe-master.min.js"></script>

<!--<script src='https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js'></script>-->
<script src='/script/aframe-ar-nft.js'></script>
<link rel="stylesheet" href="/css/styles.css">
<script>
    window.onload = function () {
        AFRAME.registerComponent('videohandler', {
            init: function () {
                var marker = this.el;
                  
                marker.addEventListener('markerFound', function () {
                    a=this.el.getAttribute("url");
                    if(a=="assets/image1"){
                        this.vid = document.querySelector("#vid1");
                    }
                    else{
                        if(a=="assets/image2"){
                        this.vid= document.querySelector("#vid2");
                    }
                    else{
                        if(a=="assets/image3"){
                        this.vid= document.querySelector("#vid3");
                    }
                    else{
                        if(a=="assets/image4"){
                        this.vid= document.querySelector("#vid4");
                    }}}}
                    this.vid.play();

                }.bind(this));

                marker.addEventListener('markerLost', function () {
                    a=this.el.getAttribute("url");
                    if(a=="assets/image1"){
                        this.vid = document.querySelector("#vid1");
                        
                    }
                    else{
                        if(a=="assets/image2"){
                        this.vid= document.querySelector("#vid2");
                    }
                    else{
                        if(a=="assets/image3"){
                        this.vid= document.querySelector("#vid3");
                    }
                    else{
                        if(a=="assets/image4"){
                        this.vid= document.querySelector("#vid4");
                    }}}}
                    this.vid.pause();

                    this.vid.currentTime = 0;
                }.bind(this));
            }
        });

        //flag to keep track of the
        let isPlaying1 = false;
        //clickable
        AFRAME.registerComponent("play-on-click", {
            init: function () {
                document.body.addEventListener("click", e => {
                    const src = this.el.getAttribute("src");
                    if (isPlaying) {
                        document.querySelector(src).pause();
                    } else {
                        document.querySelector(src).play();
                    }
                    //toggle the playing state
                    isPlaying1 = !isPlaying1;
                });
            }
        });
    };

</script>


<body style='margin : 0px; overflow: hidden;'>
    <div class="arjs-loader">
        <div>Loading, please wait...</div>
    </div>
    <a-scene vr-mode-ui="enabled: false;" renderer='antialias: true; alpha: true; precision: medium;' embedded
        arjs='trackingMethod: best; sourceType: webcam; debugUIEnabled: false;'>

        <a-assets>
            <video src="/assets/mov_bbb.mp4" preload="auto" id="vid1" response-type="arraybuffer" loop crossorigin
                webkit-playsinline playsinline>
            </video>
        </a-assets>

        <a-nft videohandler type="nft" url="assets/image3" smooth="true" smoothCount="10" smoothTolerance="0.01"
            smoothThreshold="5">
            <a-video play-on-click src="#vid1" position='50 150 -100' rotation='90 0 180' width='300' height='175'>
            </a-video>
        </a-nft>

       

        <a-entity camera></a-entity>
    </a-scene>
</body>